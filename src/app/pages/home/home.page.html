<ion-header>
  <ion-toolbar color="aula-movil">
    <ion-buttons slot="start">
      <ion-menu-button menu="menuProfile"></ion-menu-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>
<app-menu></app-menu>
<ion-content id="home" class="ion-padding-bottom">
  <ion-progress-bar type="indeterminate" color="aula-movil" *ngIf="loading"></ion-progress-bar>
  <ion-card class="ion-margin" [ngClass]="{'aula-movil-hide': hasActiveSubscription}">
    <ion-img src="https://i.pinimg.com/564x/79/c8/3e/79c83e003f469a8c5e83ed9cecc7446b.jpg"></ion-img>
    <ion-card-header>
      <ion-card-title>Obten tu subscripción</ion-card-title>
      <ion-card-subtitle>Disfruta de todas las opciones de Aula móvil con una sola subscripción</ion-card-subtitle>
    </ion-card-header>
    <ion-card-content>
      <ion-button size="block" color="aula-movil" (click)="showSubscriptionPage()">Subscripción</ion-button>
    </ion-card-content>
  </ion-card>
  <div [ngClass]="{'aula-movil-hide': !hasActiveSubscription}">
    <ion-list>
      <ion-list-header mode="ios">Cíclo Escolar</ion-list-header>
      <ion-item (click)="showAddSchoolYear()" button>
        <ion-icon slot="start" name="calendar-outline"></ion-icon>
        <ion-input placeholder="Selecciona un cíclo escolar" readonly></ion-input>
      </ion-item>
    </ion-list>
    <ion-progress-bar type="indeterminate" color="aula-movil" *ngIf="groupLoading"></ion-progress-bar>
    <div *ngIf="!groupLoading && schoolYear" class="aula-movil-groups-container">
      <ion-searchbar placeholder="Busca grupos" class="ion-padding"
                     cancelButtonIcon (ionChange)="filterGroups($event)"></ion-searchbar>
      <ion-list *ngIf="groups.length === 0">
        <ion-list-header lines="full" mode="ios">
          <ion-label>No se encontraron grupos</ion-label>
        </ion-list-header>
        <ion-card>
          <ion-card-header>
            <ion-card-subtitle><ion-skeleton-text style="width: 100px"></ion-skeleton-text></ion-card-subtitle>
            <ion-card-title><ion-skeleton-text></ion-skeleton-text></ion-card-title>
          </ion-card-header>
          <ion-card-content class="ion-no-padding">
            <ion-list class="ion-no-padding">
              <ion-item>
                <ion-skeleton-text></ion-skeleton-text>
                <ion-note slot="end"><ion-skeleton-text style="width: 10px"></ion-skeleton-text></ion-note>
              </ion-item>
              <ion-item>
                <ion-skeleton-text></ion-skeleton-text>
                <ion-note slot="end"><ion-skeleton-text style="width: 10px"></ion-skeleton-text></ion-note>
              </ion-item>
            </ion-list>
          </ion-card-content>
        </ion-card>
      </ion-list>
      <ion-card *ngFor="let group of groups" class="ion-margin" (click)="showGroupAction(group)">
        <ion-card-header class="aula-movil-groups-cover" [style.background-image]="group.backgroundCover | uriSanitizer">
          <ion-card-subtitle color="light">{{group.creationDate.toDate() | date: 'mediumDate'}}</ion-card-subtitle>
          <ion-card-title color="light">{{group.name}}</ion-card-title>
          <ion-fab horizontal="end" vertical="center" (click)="$event.stopPropagation()">
            <ion-fab-button color="light" size="small">
              <ion-icon color="aula-movil" name="settings-outline"></ion-icon>
            </ion-fab-button>
            <ion-fab-list side="start">
              <ion-fab-button (click)="showEditGroup(group)">
                <ion-icon name="create"></ion-icon>
              </ion-fab-button>
              <ion-fab-button (click)="showDeleteGroup(group)" color="danger">
                <ion-icon name="trash"></ion-icon>
              </ion-fab-button>
            </ion-fab-list>
          </ion-fab>
        </ion-card-header>
        <ion-card-content class="ion-no-padding">
          <ion-list class="ion-no-padding">
            <ion-item>
              <ion-label>Alumnos</ion-label>
              <ion-note slot="end" color="aula-movil">{{group.students}}</ion-note>
            </ion-item>
            <ion-item>
              <ion-label>Actividades</ion-label>
              <ion-note slot="end" color="aula-movil">{{group.activities}}</ion-note>
            </ion-item>
          </ion-list>
        </ion-card-content>
      </ion-card>
    </div>
    <ion-item lines="none"></ion-item>
  </div>
  <ion-fab vertical="bottom" horizontal="end" slot="fixed">
    <ion-fab-button color="aula-movil" [disabled]="!schoolYear" (click)="showAddGroup()">
      <ion-icon name="people-circle-outline"></ion-icon>
    </ion-fab-button>
  </ion-fab>
</ion-content>
